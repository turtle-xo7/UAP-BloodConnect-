{% extends 'base.html' %}


{% block title %}Donor Dashboard - UAP-BloodConnect{% endblock %}


{% block content %}
<div class="grid grid-cols-1 lg:grid-cols-4 gap-6">
   <div class="lg:col-span-3">
       <div class="card">
           <h2 style="color: var(--primary-red); margin-bottom: 1.5rem;">Welcome, {{ user.username }}! üéâ</h2>
           <p style="margin-bottom: 2rem; color: var(--gray-600);">Thank you for being a life-saver in our community.</p>

           <div class="grid grid-cols-1 md:grid-cols-3 gap-4" style="margin-bottom: 2rem;">
               <div style="text-align: center; padding: 1.5rem; background: var(--light-red); border-radius: 0.5rem;">
                   <div style="font-size: 2rem; color: var(--primary-red);">{{ donor.total_donations }}</div>
                   <div style="color: var(--gray-600);">Total Donations</div>
               </div>
               <div style="text-align: center; padding: 1.5rem; background: #dbeafe; border-radius: 0.5rem;">
                   <div style="font-size: 2rem; color: var(--secondary-blue);">{{ donor.get_availability_status_display }}</div>
                   <div style="color: var(--gray-600);">Availability</div>
               </div>
               <div style="text-align: center; padding: 1.5rem; background: #d1fae5; border-radius: 0.5rem;">
                   <div style="font-size: 2rem; color: #059669;">
                       {% if donor.can_donate_again %}‚úÖ{% else %}‚è≥{% endif %}
                   </div>
                   <div style="color: var(--gray-600);">Can Donate</div>
               </div>
           </div>
       </div>

       <div class="card">
           <h3 style="color: var(--primary-red); margin-bottom: 1.5rem;">Quick Actions</h3>
           <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
               <a href="{% url 'add_donation' %}" class="btn btn-primary" style="text-align: center;">
                   ‚ûï Add Donation Record
               </a>
               <a href="{% url 'donation_history' %}" class="btn btn-secondary" style="text-align: center;">
                   üìã View Donation History
               </a>
               <a href="{% url 'request_list' %}" class="btn btn-outline" style="text-align: center;">
                   üîç Find Blood Requests
               </a>
               <a href="{% url 'donor_directory' %}" class="btn btn-outline" style="text-align: center;">
                   üë• Browse Donors
               </a>
           </div>
       </div>

       {% if donation_history %}
       <div class="card">
           <h3 style="color: var(--primary-red); margin-bottom: 1.5rem;">Recent Donations</h3>
           <div style="overflow-x: auto;">
               <table style="width: 100%; border-collapse: collapse;">
                   <thead>
                       <tr style="background: var(--gray-100);">
                           <th style="padding: 1rem; text-align: left;">Date</th>
                           <th style="padding: 1rem; text-align: left;">Units</th>
                           <th style="padding: 1rem; text-align: left;">Hospital</th>
                           <th style="padding: 1rem; text-align: left;">Status</th>
                       </tr>
                   </thead>
                   <tbody>
                       {% for donation in donation_history %}
                       <tr style="border-bottom: 1px solid var(--gray-200);">
                           <td style="padding: 1rem;">{{ donation.donation_date }}</td>
                           <td style="padding: 1rem;">{{ donation.units_donated }}</td>
                           <td style="padding: 1rem;">{{ donation.hospital|default:"-" }}</td>
                           <td style="padding: 1rem;">
                               <span style="color: {% if donation.status == 'completed' %}green{% else %}orange{% endif %};">
                                   {{ donation.get_status_display }}
                               </span>
                           </td>
                       </tr>
                       {% endfor %}
                   </tbody>
               </table>
           </div>
       </div>
       {% endif %}
   </div>

   <div class="lg:col-span-1">
       <div class="card">
           <h3 style="color: var(--primary-red); margin-bottom: 1rem;">Your Profile</h3>
           <div style="margin-bottom: 1rem;">
               <strong>Blood Group:</strong><br>
               {% if donor.blood_group.blood_type == "A+" %}
                   <span class="blood-badge blood-a-plus">{{ donor.blood_group.blood_type }}</span>
               {% elif donor.blood_group.blood_type == "A-" %}
                   <span class="blood-badge blood-a-minus">{{ donor.blood_group.blood_type }}</span>
               {% elif donor.blood_group.blood_type == "B+" %}
                   <span class="blood-badge blood-b-plus">{{ donor.blood_group.blood_type }}</span>
               {% elif donor.blood_group.blood_type == "B-" %}
                   <span class="blood-badge blood-b-minus">{{ donor.blood_group.blood_type }}</span>
               {% elif donor.blood_group.blood_type == "O+" %}
                   <span class="blood-badge blood-o-plus">{{ donor.blood_group.blood_type }}</span>
               {% elif donor.blood_group.blood_type == "O-" %}
                   <span class="blood-badge blood-o-minus">{{ donor.blood_group.blood_type }}</span>
               {% elif donor.blood_group.blood_type == "AB+" %}
                   <span class="blood-badge blood-ab-plus">{{ donor.blood_group.blood_type }}</span>
               {% elif donor.blood_group.blood_type == "AB-" %}
                   <span class="blood-badge blood-ab-minus">{{ donor.blood_group.blood_type }}</span>
               {% else %}
                   <span class="blood-badge">{{ donor.blood_group.blood_type }}</span>
               {% endif %}
           </div>
           <div style="margin-bottom: 1rem;">
               <strong>Location:</strong><br>
               {{ donor.get_location_display }}
           </div>
           <div style="margin-bottom: 1rem;">
               <strong>Emergency Response:</strong><br>
               {% if donor.emergency_response %}
               <span style="color: green;">‚úÖ Enabled</span>
               {% else %}
               <span style="color: var(--gray-600);">‚ùå Disabled</span>
               {% endif %}
           </div>
       </div>

       {% if achievements %}
       <div class="card">
           <h3 style="color: var(--primary-red); margin-bottom: 1rem;">Achievements</h3>
           {% for achievement in achievements %}
           <div style="background: var(--light-red); padding: 1rem; border-radius: 0.5rem; margin-bottom: 0.5rem;">
               <div style="font-weight: 600; color: var(--primary-red);">{{ achievement.title }}</div>
               <div style="font-size: 0.875rem; color: var(--gray-600);">{{ achievement.description }}</div>
           </div>
           {% endfor %}
       </div>
       {% endif %}
   </div>
</div>
{% endblock %}
